<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
</head>

<body>
<ul id="list">
</ul>
<script>

/*组合模式：
将对象组合成树形结构以表示‘部分-整体’的层次结构。组合模式使得用户对单个对象和组合对象的使用具有一致性*/

/*function Foo(name){
	this.name = name;
	this.childs = [];
}
Foo.prototype.add = function(node){
	this.childs.push(node);
};

function Bar(name){
	this.name = name;
}

var root = new Foo('组合对象1-1');
var leaf1 = new Bar('叶子对象2-1');
root.add(leaf1);
var comp1 = new Foo('组合对象2-2');
root.add(comp1);
var comp2 = new Foo('组合对象3-1');
comp1.add(comp2);
var comp3 = new Foo('组合对象3-2');
comp1.add(comp3);
var leaf2 = new Bar('叶子对象4-1');
comp2.add(leaf2);
var leaf3 = new Bar('叶子对象4-2');
comp2.add(leaf3);
var leaf4 = new Bar('叶子对象4-3');
comp3.add(leaf4);
var leaf5 = new Bar('叶子对象4-4');
comp3.add(leaf5);

show(root);
function show(node){
	console.log(node.name);
	if(!node.childs){
		return;
	}
	for(var i=0;i<node.childs.length;i++){
		show(node.childs[i]);
	}
}*/

function Foo(name){
	this.name = name;
	this.childs = [];
}
Foo.prototype.add = function(node){
	this.childs.push(node);
};

function Bar(name){
	this.name = name;
}

var root = new Foo('组合对象1-1');
var leaf1 = new Bar('叶子对象2-1');
root.add(leaf1);
var comp1 = new Foo('组合对象2-2');
root.add(comp1);
var comp2 = new Foo('组合对象3-1');
comp1.add(comp2);
var comp3 = new Foo('组合对象3-2');
comp1.add(comp3);
var leaf2 = new Bar('叶子对象4-1');
comp2.add(leaf2);
var leaf3 = new Bar('叶子对象4-2');
comp2.add(leaf3);
var leaf4 = new Bar('叶子对象4-3');
comp3.add(leaf4);
var leaf5 = new Bar('叶子对象4-4');
comp3.add(leaf5);

var list = document.getElementById('list');
show(root,list);
list.onclick = function(ev){
	if(ev.target.nodeName.toLowerCase() == 'li'){
		var child = ev.target.children;
		for(var i=0;i<child.length;i++){
			if(child[i].nodeName.toLowerCase() == 'ul' && !child[i].flag){
				child[i].style.display = 'none';
				child[i].flag = true;
			}
			else if(child[i].nodeName.toLowerCase() == 'ul'){
				child[i].style.display = 'block';
				child[i].flag = false;
			}
		}
	}
};

function show(node,parent){
	var li = document.createElement('li');
	li.innerHTML = node.name;
	parent.appendChild(li);
	if(!node.childs){
		return;
	}
	for(var i=0;i<node.childs.length;i++){
		var childUl = document.createElement('ul');
		li.appendChild(childUl);
		show(node.childs[i],childUl);
	}
}

</script>
</body>
</html>
